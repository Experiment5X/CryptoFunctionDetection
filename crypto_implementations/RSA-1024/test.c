#include <stdio.h> 
#include <time.h>
#include <math.h> 

void temp_disp(uint64_t x[], uint32_t n);

uint64_t x[20]={0},y[20]={0},z[20]={0},e[18]={0};
int main()
{
	int i;
	uint8_t data[150]={0xbc,0xd8,0xb9,0x11,0x5b,0x57,0xc6,0x8f,0x90,0xc2,0xed,0x97,0x62,0x84,0x2e,0x21,0x99,0x4c,0xb0,0x2d,0xe5,0x75,0x9f,0x87,0x38,0x23,0xad,0xa4,0x74,0xdb,0x16,0x5a,0x29,0x39,0xd8,0xad,0x21,0xcb,0x9c,0x7b,0xbc,0x99,0xc2,0x83,0x5e,0x0d,0x7c,0xd6,0xc5,0x29,0xd2,0xd0,0x71,0xf6,0xa5,0x42,0xc9,0xe0,0x5c,0x5c,0xe2,0xa3,0x91,0x9b,0x1a,0x2d,0x60,0x14,0x0b,0x7c,0x0a,0xfd,0x54,0x5f,0xc7,0xc1,0x0c,0xeb,0xe9,0x59,0x23,0x51,0xf0,0x3e,0x95,0x8f,0xcf,0xf6,0x43,0xcc,0x08,0xf4,0x58,0x62,0xcc,0xe9,0x49,0x6a,0x46,0xb6,0x5a,0x72,0xb4,0x0c,0x38,0xf0,0xc0,0x82,0xd7,0x2e,0xf9,0x9e,0x97,0x2d,0xe6,0xee,0xa9,0xb9,0xe0,0xda,0x9d,0xaa,0xe3,0xd1,0x32,0xd9,0xea,0xf9};
	char msg[150] = {0};
	clock_t start_enc,stop_enc,start_dec,stop_dec;
	unsigned long us_enc=0,us_dec = 0;
	strcpy(msg,"hello, this is first rsa encode.");
	for(i=0;i<16;i++)
	{
	    x[i] = (uint64_t)rand()*(uint64_t)rand();
	    y[i] = (uint64_t)rand()*(uint64_t)rand();
	}
	for(i=0;i<64;i++)
	{
	    uint8_t temp=data[i];
	    data[i]=data[127-i];
	    data[127-i]=temp;
	}
	for(i=128;i<150;i++)
	    data[i]=0;
	//temp_disp(msg,18);
	//temp_disp(data,18);
	e[0] = 0x10001;
	//temp_disp(e,18);
	//encryption
	start_enc = clock();
	for(i=0;i<10;i++)
	    rsa1024(z,x,e,data);
	stop_enc = clock();
	//decryption
    start_dec = clock();
    for(i=0;i<10;i++)
        rsa1024(z,x,y,data);
    stop_dec = clock();
	//temp_disp(z,18);
    us_enc = (stop_enc - start_enc)/10 ;
    us_dec = (stop_dec - start_dec)/10 ;
	printf("Avg time taken for 1024 bit rsa encryption is %ld ms\n",us_enc/1000);
	printf("Avg time taken for 1024 bit rsa decryption is %ld ms\n",us_dec/1000);

	return 0;
}

void temp_disp(uint64_t x[], uint32_t n)
{
	for( ; n>0 ; n--)
	{
		printf("%016lx",x[n-1]);
	}
	printf("\n");
	return;
}
